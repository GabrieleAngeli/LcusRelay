# Config Triggers & Examples

## Available Triggers (out of the box)
### Session (Windows)
- `session:logon`
- `session:logoff`
- `session:lock`
- `session:unlock`
- `session:remoteconnect` (RDP connection established)
- `session:remotedisconnect` (RDP connection closed)

### Hotkey
- `hotkey:{name}` (e.g. `hotkey:toggle`) - generated by entries in `hotkeys[]`

### Schedule (cron)
- `schedule:{name}` (e.g. `schedule:weekdays-off-23`) - generated by entries in `schedules[]`

### Signals (process/state)
- `signal:meeting:on`
- `signal:meeting:off`
- `signal:rdp:on`
- `signal:rdp:off`
- `signal:{name}:on`
- `signal:{name}:off`

Notes:
- "meeting" is based on configured processes (`meetingSignal.processNames`) and polling.
- "rdp" is based on the session state (useful to distinguish local vs remote).
- `signal:{name}:on/off` comes from `softwareSignals.signals[]`.

## Supported Actions
- `relay` with `state: On|Off|Toggle`
- `delay` with `milliseconds`
- `run` (execute a process)
- `webhook` (HTTP)
- `blink` (relay blink sequence)

## Auto Update (GitHub Releases)
The app can check GitHub Releases on startup and, after user approval, download and run the installer.

```json
{
  "update": {
    "enabled": true,
    "checkOnStartup": true,
    "repoOwner": "your-org-or-user",
    "repoName": "your-repo",
    "installerAssetName": "LcusRelay-Setup.exe",
    "autoInstallOnApproval": true
  }
}
```

Notes:
- `repoOwner` and `repoName` must match your GitHub repository.
- The release must include an asset named `LcusRelay-Setup.exe` (or the name you set here).

## Series Guard (optional)
Each rule can define:
- `series`: the origin group for the rule (e.g. `manual`, `session`, `schedule`).
- `allowWhenLastSeries`: if present, the rule is executed only if the **last relay state change** came from one of these series.

This is used to avoid "automatic" events overriding a manual change.

## `softwareSignals` Section
Example (includes a `ninja-desktop` signal that is ON only when the process exists and the session is RDP):

```json
{
  "softwareSignals": {
    "enabled": true,
    "emitRdpSignal": true,
    "pollSeconds": 2,
    "signals": [
      {
        "name": "ninja-desktop",
        "enabled": true,
        "requireRdp": true,
        "processNames": ["NinjaRMMAgentPatcher", "NinjaRMMAgent"]
      }
    ]
  }
}
```

## Example: Turn off at logon and logoff
```json
{
  "rules": [
    { "trigger": "session:logon",  "actions": [{ "type": "relay", "state": "Off" }] },
    { "trigger": "session:logoff", "actions": [{ "type": "relay", "state": "Off" }] }
  ]
}
```

## Example: Toggle with Ctrl+Alt+L
```json
{
  "hotkeys": [
    {
      "name": "toggle",
      "modifiers": ["Control","Alt"],
      "key": "L",
      "series": "manual",
      "actions": [{ "type": "relay", "state": "Toggle" }]
    }
  ]
}
```

## Example: Turn off at 23:00 Mon-Fri and on at 07:30 Mon-Fri
```json
{
  "schedules": [
    { "name": "weekdays-off-23",  "cron": "0 23 * * 1-5",  "series": "schedule",
      "actions": [{ "type": "relay", "state": "Off" }] },
    { "name": "weekdays-on-0730", "cron": "30 7 * * 1-5", "series": "schedule",
      "actions": [{ "type": "relay", "state": "On" }] }
  ]
}
```
